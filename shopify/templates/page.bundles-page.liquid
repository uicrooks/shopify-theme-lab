{% assign oosItems = settings.oos_sku_array | downcase | split: ',' %} {% assign
  starterBundles = collections['bundle-offers-starter-bundles'].products %}
  {% assign bestSellers = collections['bundle-offers-best-sellers'].products
  %} {% assign fullRoutine =
  collections['bundle-offers-full-routine'].products %} {% assign soapSets =
  collections['bundle-offers-soap-sets'].products %} {% assign deoSets =
  collections['bundle-offers-deodorant-sets'].products %} {% assign signatureScents
  = collections['bundle-offers-signature-scents'].products %}

{% assign soapSubscriptions = collections['soap-subscriptions'].products %}
{% assign hairSubscriptions = collections['haircare-subscriptions'].products %}
{% assign deodorantSubscriptions = collections['deodorant-subscriptions'].products %}
{% assign toothpasteSubscriptions = collections['toothpaste-subscriptions'].products %} 


{% capture soapSubDetails %}
[
  {% for product in soapSubscriptions %}
  {
    "variant_id": {{product.variants[0].id}},
    "sku": "{{product.variants[0].sku | downcase }}",
    "type": "{{product.type}}",
    "price": {{product.variants[0].price | divided_by: 100 }},
    "compare_at_price": {{product.variants[0].compare_at_price | divided_by: 100 }},
    "properties": {
      "type": "soap",
      "subscription_id": {{ product.metafields.subscriptions.subscription_id }},
      "shipping_interval_unit_type": "{{ product.metafields.subscriptions.shipping_interval_unit_type }}",
      "charge_internal_frequency": {{ product.variants[0].metafields.subscription.charge_internal_frequency }},
      "shipping_interval_frequency": {{ product.variants[0].metafields.subscription.shipping_interval_frequency }},
      "discount_variant_id": {{ product.variants[0].metafields.subscriptions.discount_variant_id }},
      "_recurring_shipping_interval_frequency": {{ product.variants[0].metafields.subscription.shipping_interval_frequency }},
      "_recurring_shipping_interval_unit_type": "{{ product.metafields.subscriptions.shipping_interval_unit_type }}",
      "_recurring_charge_interval_frequency": {{ product.variants[0].metafields.subscription.charge_internal_frequency }},
      "_recurring_subscription_id": {{ product.metafields.subscriptions.subscription_id }},
      "_inventory_type": true
    }
  }{% unless forloop.last %},{% endunless %}
  {% endfor %}
]
{% endcapture %}
{% capture haircareSubDetails %}
[
  {% for product in hairSubscriptions %}
  {
    "variant_id": {{product.variants[0].id}},
    "sku": "{{product.variants[0].sku | downcase }}",
    "type": "{{product.type}}",
    "price": {{product.variants[0].price | divided_by: 100 }},
    "compare_at_price": {{product.variants[0].compare_at_price | divided_by: 100 }},
    "properties": {
      "type": "haircare",
      "subscription_id": {{ product.metafields.subscriptions.subscription_id }},
      "shipping_interval_unit_type": "{{ product.metafields.subscriptions.shipping_interval_unit_type }}",
      "charge_internal_frequency": {{ product.variants[0].metafields.subscription.charge_internal_frequency }},
      "shipping_interval_frequency": {{ product.variants[0].metafields.subscription.shipping_interval_frequency }},
      "discount_variant_id": {{ product.variants[0].metafields.subscriptions.discount_variant_id }},
      "_recurring_shipping_interval_frequency": {{ product.variants[0].metafields.subscription.shipping_interval_frequency }},
      "_recurring_shipping_interval_unit_type": "{{ product.metafields.subscriptions.shipping_interval_unit_type }}",
      "_recurring_charge_interval_frequency": {{ product.variants[0].metafields.subscription.charge_internal_frequency }},
      "_recurring_subscription_id": {{ product.metafields.subscriptions.subscription_id }},
      "_inventory_type": true
    }
  }{% unless forloop.last %},{% endunless %}
  {% endfor %}
]
{% endcapture %}
{% capture deodorantSubDetails %}
[
  {% for product in deodorantSubscriptions %}
  {
    "variant_id": {{product.variants[0].id}},
    "sku": "{{product.variants[0].sku | downcase }}",
    "type": "{{product.type}}",
    "price": {{product.variants[0].price | divided_by: 100 }},
    "compare_at_price": {{product.variants[0].compare_at_price | divided_by: 100 }},
    "properties": {
      "type": "deodorant",
      "subscription_id": {{ product.metafields.subscriptions.subscription_id }},
      "shipping_interval_unit_type": "{{ product.metafields.subscriptions.shipping_interval_unit_type }}",
      "charge_internal_frequency": {{ product.variants[0].metafields.subscription.charge_internal_frequency }},
      "shipping_interval_frequency": {{ product.variants[0].metafields.subscription.shipping_interval_frequency }},
      "discount_variant_id": {{ product.variants[0].metafields.subscriptions.discount_variant_id }},
      "_recurring_shipping_interval_frequency": {{ product.variants[0].metafields.subscription.shipping_interval_frequency }},
      "_recurring_shipping_interval_unit_type": "{{ product.metafields.subscriptions.shipping_interval_unit_type }}",
      "_recurring_charge_interval_frequency": {{ product.variants[0].metafields.subscription.charge_internal_frequency }},
      "_recurring_subscription_id": {{ product.metafields.subscriptions.subscription_id }},
      "_inventory_type": true
    }
  }{% unless forloop.last %},{% endunless %}
  {% endfor %}
]
{% endcapture %}
{% capture toothpasteSubDetails %}
[
  {% for product in toothpasteSubscriptions %}
  {
    "variant_id": {{product.variants[0].id}},
    "sku": "{{product.variants[0].sku | downcase }}",
    "type": "{{product.type}}",
    "price": {{product.variants[0].price | divided_by: 100 }},
    "compare_at_price": {{product.variants[0].compare_at_price | divided_by: 100 }},
    "properties": {
      "type": "toothpaste",
      "subscription_id": {{ product.metafields.subscriptions.subscription_id }},
      "shipping_interval_unit_type": "{{ product.metafields.subscriptions.shipping_interval_unit_type }}",
      "charge_internal_frequency": {{ product.variants[0].metafields.subscription.charge_internal_frequency }},
      "shipping_interval_frequency": {{ product.variants[0].metafields.subscription.shipping_interval_frequency }},
      "discount_variant_id": {{ product.variants[0].metafields.subscriptions.discount_variant_id }},
      "_recurring_shipping_interval_frequency": {{ product.variants[0].metafields.subscription.shipping_interval_frequency }},
      "_recurring_shipping_interval_unit_type": "{{ product.metafields.subscriptions.shipping_interval_unit_type }}",
      "_recurring_charge_interval_frequency": {{ product.variants[0].metafields.subscription.charge_internal_frequency }},
      "_recurring_subscription_id": {{ product.metafields.subscriptions.subscription_id }},
      "_inventory_type": true
    }
  }{% unless forloop.last %},{% endunless %}
  {% endfor %}
]
{% endcapture %}
  
  <bundle-offers-template
    :bundles="{
      'Starter Bundles': {{ starterBundles | json | escape }},
      'Best Sellers': {{ bestSellers | json | escape }},
      'Full Routine': {{ fullRoutine | json | escape }},
      'Soap Sets': {{ soapSets | json | escape }},
      'Deodorant Sets': {{ deoSets | json | escape }},
      'Signature Scents': {{ signatureScents | json | escape }}
    }"
    :barSoapSubDetails="{{soapSubDetails | json | escape }}"
    :deodorantSubDetails="{{deodorantSubDetails | json | escape }}"
    :haircareSubDetails="{{haircareSubDetails | json | escape }}"
    :toothpasteSubDetails="{{toothpasteSubDetails | json | escape }}"
  ></bundle-offers-template>
  